<% title "Members" %>
<% highlight_tab "networks" %>
<h2>CompSage Members</h2>
<p>Explore the community. Invite members to join one of <%=link_to "your networks", networks_path %> or to take part in
  a survey you are sponsoring.</p>
<%=flash_messages%>
<%= render :partial => "search_form" %>
<p><%= link_to "All organizations", search_organizations_path %></p>
<% if @organizations.size == 0 then %>
  <p>Your search returned zero results</p>
<% else %>
  <ul id="organizations" class="entity_list">
    <% @organizations.each_with_geodist do | organization, geodist | %>  
      <%= render :partial => "organization", :object => organization, :locals => {:geodist => (geodist/1609.344).round(1) } %>
    <% end %>
  </ul>
  <%= will_paginate @organizations %>
<% end %>

<script type="text/javascript">

function initializeObservers() {
  <% @organizations.each do |organization| %>
  	$('<%="survey_organization_#{organization.id}_survey_id"%>').observe(
  	  'change', 
  	  sendInvitation.curry('<%=organization.id%>','<%=surveys_path%>'));
    $('<%="network_organization_#{organization.id}_network_id"%>').observe(
      'change', 
      sendInvitation.curry('<%=organization.id%>','<%=networks_path%>'));	
  <% end %>
}

</script>

<% content_for :initialize_js, "initializeObservers();"%>

